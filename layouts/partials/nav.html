<header class="im-header" role="banner" aria-label="Site header">
  <div class="im-header__inner">
    <a class="im-brand" href="{{ "/" | relURL }}">Ian Milligan</a>

    <!-- CSS-only toggle (no JS) -->
    <input id="im-navtoggle" type="checkbox" class="im-toggle" aria-label="Toggle menu">
    <label for="im-navtoggle" class="im-burger">
      <span class="im-burger__icon" aria-hidden="true"></span>
      <span class="sr-only">Menu</span>
    </label>

    <nav class="im-menu" aria-label="Primary">
      <ul class="im-nav">
        {{- range .Site.Menus.main }}
          <li>
            <a href="{{ .URL | relURL }}"
               {{- if or (eq $.Page.RelPermalink (.URL | relURL)) ($.Page.IsMenuCurrent "main" .) -}} aria-current="page"{{- end -}}>
              {{ .Name }}
            </a>
          </li>
        {{- end }}
      </ul>
    </nav>
  </div>

  <style>
    /* ---- utilities ---- */
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    /* ---- header layout ---- */
    .im-header__inner{
      max-width:72rem;margin:0 auto;padding:.75rem 1rem;
      display:flex;align-items:center;justify-content:space-between;gap:1rem
    }
    .im-brand{font-weight:700;text-decoration:none}

    /* ---- menu ---- */
    .im-nav{display:flex;gap:1rem;margin:0;padding:0;list-style:none}
    .im-nav a{
      display:block;padding:.5rem .75rem;border-radius:.6rem;text-decoration:none;
      border:1px solid rgba(0,0,0,.18);
      border:1px solid color-mix(in oklab, CanvasText 18%, transparent);
    }
    .im-nav a[aria-current="page"]{
      font-weight:600;
      background: rgba(0,0,0,.06);
      background: color-mix(in oklab, CanvasText 6%, transparent);
    }

    /* ---- hamburger button ---- */
    .im-toggle{display:none}
    .im-burger{
      display:none;line-height:0;cursor:pointer;background:transparent;
      border:1px solid rgba(0,0,0,.20);
      border:1px solid color-mix(in oklab, CanvasText 20%, transparent);
      padding:.5rem;border-radius:.6rem
    }
    .im-burger__icon,
    .im-burger__icon::before,
    .im-burger__icon::after{
      content:"";display:block;width:22px;height:2px;background:currentColor;border-radius:2px;
      transition:transform .18s ease, opacity .18s ease, background .18s ease
    }
    .im-burger__icon{position:relative}
    .im-burger__icon::before{position:absolute;left:0;transform:translateY(-6px)}
    .im-burger__icon::after {position:absolute;left:0;transform:translateY(6px)}

    /* ---- mobile ---- */
    @media (max-width:768px){
      .im-burger{display:inline-flex;align-items:center;justify-content:center}
      .im-menu{display:none;width:100%}
      #im-navtoggle:checked ~ .im-menu{display:block}
      .im-nav{display:grid;gap:.5rem;margin-top:.5rem}

      /* animate burger -> X */
      #im-navtoggle:checked + .im-burger .im-burger__icon{background:transparent}
      #im-navtoggle:checked + .im-burger .im-burger__icon::before{transform:rotate(45deg)}
      #im-navtoggle:checked + .im-burger .im-burger__icon::after {transform:rotate(-45deg)}
    }

    /* ---- desktop ---- */
    @media (min-width:769px){ .im-menu{display:block} }

    /* ---- dark mode tweaks ---- */
    @media (prefers-color-scheme: dark){
      .im-nav a[aria-current="page"]{
        background: color-mix(in oklab, Canvas 86%, CanvasText 0%);
      }
    }
  </style>
</header>